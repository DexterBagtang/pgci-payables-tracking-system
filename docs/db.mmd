erDiagram
    users {
        int id PK
        varchar name
        varchar username UK
        varchar role
        varchar email UK
        datetime email_verified_at
        varchar password
        varchar remember_token
        datetime created_at
        datetime updated_at
    }

    vendors {
        int id PK
        varchar name
        varchar email
        varchar phone
        text address
        varchar category
        varchar payment_terms
        boolean is_active
        varchar vendor_type
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    projects {
        int id PK
        varchar project_title
        varchar cer_number
        numeric total_project_cost
        numeric total_contract_cost
        varchar project_status
        text description
        varchar project_type
        varchar smpo_number
        varchar philcom_category
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    purchase_orders {
        int id PK
        varchar po_number UK
        int project_id FK
        int vendor_id FK
        numeric po_amount
        varchar po_status
        varchar payment_term
        date po_date
        date expected_delivery_date
        text description
        int created_by FK
        int finalized_by FK
        datetime finalized_at
        datetime created_at
        datetime updated_at
    }

    po_line_items {
        int id PK
        int po_id FK
        varchar item_description
        numeric quantity
        numeric unit_price
        numeric total_amount "GENERATED"
        varchar unit_of_measure
        datetime created_at
        datetime updated_at
    }

    invoices {
        int id PK
        int po_id FK
        varchar si_number
        date si_date
        date si_received_at
        date received_date
        varchar payment_type
        numeric invoice_amount
        numeric tax_amount
        numeric discount_amount
        numeric net_amount "GENERATED"
        varchar invoice_status
        date due_date
        text notes
        date submitted_at
        varchar submitted_to
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    check_requisitions {
        int id PK
        varchar requisition_number UK
        int invoice_id FK
        varchar requisition_status
        numeric php_amount
        date request_date
        varchar payee_name
        text purpose
        text payment_for
        varchar po_number
        varchar cer_number
        varchar si_number
        varchar account_charge
        varchar budget_code
        varchar service_line_dist
        text amount_in_words
        varchar requested_by
        varchar reviewed_by
        varchar approved_by
        varchar payment_method
        int generated_by FK
        datetime approved_at
        int processed_by FK
        datetime processed_at
        datetime created_at
        datetime updated_at
    }

%% REMARKS TABLES
    vendor_remarks {
        int id PK
        int vendor_id FK
        varchar remark_type
        text remark_text
        varchar priority
        boolean is_internal
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    project_remarks {
        int id PK
        int project_id FK
        varchar remark_type
        text remark_text
        varchar priority
        boolean is_internal
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    po_remarks {
        int id PK
        int po_id FK
        varchar remark_type
        text remark_text
        varchar priority
        boolean is_internal
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    invoice_remarks {
        int id PK
        int invoice_id FK
        varchar remark_type
        text remark_text
        varchar priority
        boolean is_internal
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    requisition_remarks {
        int id PK
        int requisition_id FK
        varchar remark_type
        text remark_text
        varchar priority
        boolean is_internal
        int created_by FK
        datetime created_at
        datetime updated_at
    }

    audit_trails {
        int id PK
        varchar table_name
        int record_id
        varchar action
        text changes
        int user_id FK
        datetime performed_at
        varchar ip_address
        text user_agent
    }

    files {
        int id PK
        varchar fileable_type
        int fileable_id
        varchar file_name
        varchar file_path
        varchar file_type
        varchar file_category
        varchar file_purpose
        int file_size
        varchar disk
        text description
        boolean is_active
        int uploaded_by FK
        datetime created_at
        datetime updated_at
    }

    reviews {
        int id PK
        varchar reviewable_type
        int reviewable_id
        int reviewer_id FK
        varchar status
        text comments
        datetime reviewed_at
        datetime created_at
        datetime updated_at
    }


%% Core Entity Relationships
    users ||--o{ vendors : "created_by"
    users ||--o{ projects : "created_by"
    users ||--o{ purchase_orders : "created_by"
    users ||--o{ purchase_orders : "finalized_by"
    users ||--o{ invoices : "created_by"
    users ||--o{ check_requisitions : "generated_by"
    users ||--o{ check_requisitions : "processed_by"
    users ||--o{ audit_trails : "user_id"
    users ||--o{ files : "uploaded_by"

    vendors ||--o{ purchase_orders : "has"
    projects ||--o{ purchase_orders : "has"
    purchase_orders ||--|| po_line_items : "has"
    purchase_orders ||--o{ invoices : "has"
    invoices ||--o{ check_requisitions : "generates"

%% Remarks Relationships
    vendors ||--o{ vendor_remarks : "has"
    projects ||--o{ project_remarks : "has"
    purchase_orders ||--o{ po_remarks : "has"
    invoices ||--o{ invoice_remarks : "has"
    check_requisitions ||--o{ requisition_remarks : "has"

    users ||--o{ vendor_remarks : "created_by"
    users ||--o{ project_remarks : "created_by"
    users ||--o{ po_remarks : "created_by"
    users ||--o{ invoice_remarks : "created_by"
    users ||--o{ requisition_remarks : "created_by"

%% File relationships (polymorphic)
    files }|--|| users : "uploaded_by"
    files }o--o{ projects : "fileable"
    files }o--o{ vendors : "fileable"
    files }o--o{ purchase_orders : "fileable"
    files }o--o{ invoices : "fileable"
    files }o--o{ check_requisitions : "fileable"

    users ||--o{ reviews : "reviewer_id"

    invoices ||--o{ reviews : "reviewable"

    check_requisitions ||--o{ reviews : "reviewable"
